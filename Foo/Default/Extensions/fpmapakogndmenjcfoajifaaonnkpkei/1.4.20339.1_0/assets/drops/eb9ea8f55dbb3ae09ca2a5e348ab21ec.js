/*
COPYRIGHT (C) 2013-2020 PROCTORIO INC.
USE OF THIS SOFTWARE IS PROTECTED BY COPYRIGHT LAWS AND INTERNATIONAL COPYRIGHT TREATIES,
AS WELL AS OTHER INTELLECTUAL PROPERTY LAWS AND TREATIES.
UNAUTHORIZED REPRODUCTION, DISPLAY, MODIFICATION, OR DISTRIBUTION OF THIS SOFTWARE, OR ANY PORTION OF IT,
MAY RESULT IN SEVERE CIVIL AND CRIMINAL PENALTIES, AND WILL BE PROSECUTED TO THE FULL EXTENT PERMITTED BY LAW.
USE OF THIS SOFTWARE IS CONDITIONED ON YOUR ACCEPTANCE OF OUR TERMS OF SERVICE, FOUND AT PROCTORIO.COM/TOS.
OPEN SOURCE LICENSES CAN BE FOUND IN THE LICENSE.TXT FILE OR ONLINE AT PROCTORIO.COM/LICENSES.
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(c,h,d){if(null==c)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(h instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return c+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,h,d){c!=Array.prototype&&c!=Object.prototype&&(c[h]=d.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,h,d,m){if(h){d=$jscomp.global;c=c.split(".");for(m=0;m<c.length-1;m++){var e=c[m];e in d||(d[e]={});d=d[e]}c=c[c.length-1];m=d[c];h=h(m);h!=m&&null!=h&&$jscomp.defineProperty(d,c,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("String.prototype.startsWith",function(c){return c?c:function(c,d){var h=$jscomp.checkStringArgs(this,c,"startsWith");c+="";var e=h.length,l=c.length;d=Math.max(0,Math.min(d|0,h.length));for(var n=0;n<l&&d<e;)if(h[d++]!=c[n++])return!1;return n>=l}},"es6","es3");$jscomp.findInternal=function(c,h,d){c instanceof String&&(c=String(c));for(var m=c.length,e=0;e<m;e++){var l=c[e];if(h.call(d,l,e,c))return{i:e,v:l}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,d){return $jscomp.findInternal(this,c,d).v}},"es6","es3");$jscomp.polyfill("Array.from",function(c){return c?c:function(c,d,m){d=null!=d?d:function(c){return c};var h=[],l="undefined"!=typeof Symbol&&Symbol.iterator&&c[Symbol.iterator];if("function"==typeof l){c=l.call(c);for(var n=0;!(l=c.next()).done;)h.push(d.call(m,l.value,n++))}else for(l=c.length,n=0;n<l;n++)h.push(d.call(m,c[n],n));return h}},"es6","es3");
(function(c,h){function d(a){a=a.split("+").join(" ");for(var c={},b,h=/[?&]?([^=]+)=([^&]*)/g;b=h.exec(a);)c[decodeURIComponent(b[1])]=decodeURIComponent(b[2]);return c}function m(a,c){if(a())c();else var b=setInterval(function(){a()&&(clearInterval(b),c())},100)}function e(){var b=a[0].getElementById("content_listContainer");if(-1!=a[0].location.href.indexOf("/course/tools/"))b=a.find("#content div.landingPageColumn ul li a").not(":contains('Secure Exam Proctor')").parent().parent(),b.find("p").css("display",
"block"),b.find("img").css("display","inline"),b.find("h3 a").css("display","inline"),b.find("span.caretTitleModifier").css("display","inline"),b.find("span.linkStatus").css("display","inline");else if(-1!=a[0].location.href.indexOf("/content/listContent")&&b){b=b.getElementsByTagName("li");for(var e=0;e<b.length;e++){var y=b[e].querySelector("h3 a span");y&&y.innerText&&"secure exam proctor"==y.innerText.trim().toLowerCase()?b[e].style.display="none":b[e].style.display="block"}}else b=a.find("#content div.landingPageColumn"),
b.find('a[href*="blti_placement_id"]').show(),b.find('img[src*="blti_icons"]').show(),b.find("p.helphelp").show(),b.find("span.caretTitleModifier").show(),b.find("span.linkStatus").show(),a.find("#content_listContainer li").show();if(!a.find("body").attr("data-p")){a.find("body").attr("data-p",!0);if(-1!=a[0].location.pathname.indexOf("assessment/take/launchAssessment.jsp")){clearInterval(v);b=a.find("h1").text().trim();if(a.find(".proctorio-embed").length||-1!=b.indexOf("(Remotely Proctored)")||
-1!=b.indexOf("(Secure Browser)")||a.find("iframe[src$='.vo.msecnd.net/lti/exam']").length){a.find(".proctorio-embed").hide();a.find("iframe[src$='.vo.msecnd.net/lti/exam']").hide();a.find(".proctorio-oembed").show();a.find("div.taskbuttondiv_wrapper").hide();b=document.createElement("a");b.href=a[0].location.href;var k=d(b.search);a.find('form[action*="/assessment/take/launch-redirect"]').show();k.content_id&&m(function(){return z},function(){f.e2cc("reason",function(){var a=f.c416(k.content_id,
r);f.b1457("code",null===localStorage.getItem(a+"_close")?0:localStorage[a+"_close"])});f.f10(k.content_id,r,function(b){b&&f.c8f4(a.find("span.proctoriocontrol").length?k.content_id:0,r,w,function(d){if(d){var p=a.find("#stepcontent1 ol li:last");if(p.length){var A=[];p.parent().find("li").each(function(){A.push(c(this).text().trim().replace(/(\r\n|\n|\r)/gm," ").replace(/\s+/g," ").trim())}).promise().done(function(){chrome.runtime.sendMessage([16,k.content_id+"_is_"+k.course_id+"_oy_"+u,A,43829]);
p.after('<li><div class="label">'+chrome.i18n.getMessage("A226")+'</div><div class="field">'+chrome.i18n.getMessage("A107")+" <strong>"+chrome.i18n.getMessage("B413")+"</strong>. <a href='https://proctorio.zendesk.com/hc/articles/200972514' target='_blank' style='text-decoration:underline'>"+chrome.i18n.getMessage("B414")+"</a>.</div></li>");if(b[0]||b[1]||b[2]){var a=chrome.i18n.getMessage("A214");!b[0]&&!b[2]||b[1]?b[0]||b[2]||!b[1]||(a=chrome.i18n.getMessage("A216")):a=chrome.i18n.getMessage("A215");
p.after('<li><div class="label">'+chrome.i18n.getMessage("A217")+'</div><div class="field">'+a+"</div></li>")}chrome.runtime.sendMessage([19,!0]);chrome.runtime.sendMessage([4,chrome.i18n.getMessage("B410")]);f.e2cc("quizinfo",function(){f.b1457("quizinfo",A)})})}d=a.find("#dataCollectionContainer input[type='submit']");var e=d.first().val(),g=f.c416(k.content_id,r);"Begin"!=e&&"Comenzar"!=e&&b[15]&&localStorage["ok_"+g]!=cjs.mi6(g+"__xsalt").toString()?(a.find("#stepcontent1").html(chrome.i18n.getMessage("A159")),
a.find("p.taskbuttonhelp").remove(),d.remove(),f.e2cc("quizoverride",function(a){2==b[15]?f.b1457("quizoverride_response","denied"):a&&"none"!=a?a==cjs.mi6(g+"__xsalt").toString()?(chrome.runtime.sendMessage([3,["_trackEvent","PGHZ","yFrr_bb",h.location.hostname]]),localStorage["ok_"+g]=a,f.b1457("quizoverride_response","success"),document.location.reload()):f.b1457("quizoverride_response","invalid"):f.b1457("quizoverride",g)})):localStorage["ok_cpbb_"+g]=g;a.find(".proctorio-embed").length||chrome.runtime.sendMessage([3,
["_trackEvent","PGHZ","BRoW_bb",h.location.hostname]]);chrome.runtime.sendMessage([16,k.content_id+"_qs_"+k.course_id+"_oy_"+u,b,43829])}else{d=function(a,b){t.value=b;m[0].innerText==a&&(m[0].innerText=b);a=l.textContent.replace(a,b);l.innerText=a};var t=a[0].querySelector('#dataCollectionContainer input[type="submit"]'),l=a[0].querySelector(".taskbuttonhelp"),m=a[0].querySelectorAll("#stepcontent1 ol strong"),q=t.value;"Begin"===q?(e=chrome.i18n.getMessage("F001"),d(q,e)):"Continue"===q&&(e=chrome.i18n.getMessage("F002"),
d(q,e))}})})})}n()}else if(-1!=a[0].location.pathname.indexOf("assessment/take/launch.jsp"))clearInterval(v),a.find("h1").hide(),a.find('form[action*="/assessment/take/launch-redirect"]').hide(),b=document.createElement("a"),b.href=a[0].location.href,k=d(b.search),a.find("#isPasswordAttempted").length&&k.content_id?chrome.runtime.sendMessage([17,k.content_id+"_qs_"+k.course_id+"_oy_"+u],function(b){b||-1!=a.find("h1").text().trim().indexOf("(Remotely Proctored)")||-1!=a.find("h1").text().trim().indexOf("(Secure Browser)")?
m(function(){return z},function(){var b=-1;f.ee1(r,function(a){b=a;chrome.runtime.sendMessage([91])});f.e2cc("reason",function(){var a=f.c416(k.content_id,r);f.b1457("code",null===localStorage.getItem(a+"_close")?0:localStorage[a+"_close"])});f.f10(k.content_id,r,function(d){d?f.c8f4(k.content_id,r,w,function(e){if(e){e=a.find("#dataCollectionContainer input[type='submit']");e.first().val();var p=f.c416(k.content_id,r),g=document.getElementById("inlineReceipt_warning"),t=null!=g&&"object"===typeof g&&
g.innerText.indexOf("left the test");!t&&d[15]&&(p=f.c416(k.content_id,r),localStorage["ok_cpbb_"+p]!=p&&(t=!0));if(e.length&&(!d[15]||!t&&d[15]||t&&d[15]&&localStorage["ok_"+p]==cjs.mi6(p+"__xsalt").toString())){-1!=a[0].location.href.indexOf("#")&&(a[0].location.href=a.location[0].href.split("#")[0]);g=a.find("h1").text();var n="Unknown";-1!=g.indexOf("Enter Password:")?n=g.split("Enter Password:")[1]:-1!=g.indexOf(":")&&(g=g.split(/_(.+)?/)[1]);g=chrome.i18n.getMessage("A236")+": "+n;a.find("h1").text(g).show();
a.find("#breadcrumbs ol li.placeholder").text(g);document.title=g;g=a.find('form[action*="/assessment/take/launch-redirect"]');if(g.length){g.attr("id","proctorio_poster");g.find('input[type="password"]').attr("id","proctorio_passer");g.hide();var D=a.find("#student-preview-ribbon").length,q=c(h.top.document).find("#global-nav-link").contents();for(e=0;e<q.length-1;e++)if(q[e].tagName&&"IMG"==q[e].tagName&&q[e+1].textContent){q=q[e+1].textContent.trim();break}"string"!=typeof q&&(q=(e=localStorage.getItem("ultraStudentName"))?
e:"Student");m(function(){return-1<b},function(){f.b8d(d,a.find("#containerdiv")[0],k.content_id,r,w,"bb",q,"proctorio_poster","proctorio_passer",n,"body",x,D,b)});f.e2cc("quizinfo",function(){chrome.runtime.sendMessage([17,k.content_id+"_is_"+k.course_id+"_oy_"+u],function(a){f.b1457("quizinfo",a)})})}else a.find("#stepcontent1").html(chrome.i18n.getMessage("A159")),a.find("p.taskbuttonhelp").remove(),e.remove(),l()}else localStorage.removeItem("ok_cpbb_"+p),a.find("#stepcontent1").html(chrome.i18n.getMessage("A159")),
null!=g&&"object"===typeof g&&(g.innerHTML=chrome.i18n.getMessage("A159")),a.find("p.taskbuttonhelp").remove(),e.remove(),l(),f.e2cc("quizoverride",function(a){a&&"none"!=a?a==cjs.mi6(p+"__xsalt").toString()?(chrome.runtime.sendMessage([3,["_trackEvent","PGHZ","yFrr_bb",h.location.hostname]]),localStorage["ok_"+p]=a,document.location.reload()):f.b1457("quizoverride","invalid"):f.b1457("quizoverride",p)});chrome.runtime.sendMessage([19,!0]);chrome.runtime.sendMessage([4,chrome.i18n.getMessage("B410")])}else l()}):
l()})}):l()}):(l(),-1==a.find("h1").text().trim().indexOf("(Remotely Proctored)")&&-1==a.find("h1").text().trim().indexOf("(Secure Browser)")||chrome.runtime.sendMessage([19,!0]));else if(-1!=a[0].location.pathname.indexOf("assessment/review/review.jsp")){var C=!1;chrome.runtime.sendMessage([154,"F019 F020 F021 F022 A896 A991".split(" ")],function(a){var b=a.hasOwnProperty("F019")?a.F019:"";var c=a.hasOwnProperty("F020")?a.F020:"";var d=a.hasOwnProperty("F021")?a.F021:"";var e=a.hasOwnProperty("F022")?
a.F022:"";var g=a.A896||"";a=a.A991||"";var f=document.getElementById("pageTitleHeader");if(f){f=f.getElementsByTagName("span");if(!f.length)return;if(-1!==f[f.length-1].textContent.indexOf(g)||-1!==f[f.length-1].textContent.indexOf(a))C=!0}if(C){var k=document.createElement("div");g=document.createElement("div");a=document.createElement("p");f=document.createElement("a");var l=document.createElement("p"),m=document.createElement("span");k.setAttribute("id","co2");g.setAttribute("class","co2_header");
g.innerHTML=b;f.innerText=c;f.href="https://proctorio.com/about/sustainability";f.setAttribute("target","_blank");a.innerHTML=d;l.setAttribute("class","co2_footer");l.innerText=e;m.setAttribute("class","co2_close");a.appendChild(f);a.append(".");k.style.bottom="80px";k.appendChild(g);k.appendChild(a);k.appendChild(l);k.appendChild(m);b=document.createElement("link");b.rel="stylesheet";b.href=chrome.extension.getURL("webassets/co2.css");document.head.appendChild(b);h.top.document.body.prepend(k);k.getElementsByClassName("co2_close")[0].addEventListener("click",
function(){k.remove()})}})}else if(B(),a.find(".proctorio-oembed").show(),a.find(".proctorio-embed").hide(),a.find("iframe[src$='.vo.msecnd.net/lti/exam']").hide(),a.find('li[id^="contentListItem"]').find("a").each(function(){"undefined"!=typeof c(this).data("href")&&c(this).attr("href",c(this).data("href"))}),a.find("#containerdiv").find('img[src$="vo.msecnd.net/guides/student-logo.png"]').length){chrome.runtime.sendMessage([19,!0]);b=a.find("#containerdiv").find("div.proctorio_removeme");if(b.length)b.html('<div class="take_quiz_button" style="display: block;"><a id="primaryButton" style="text-decoration:none;font-size:20px;padding:8px 10px;" href="#">Live Chat</a></div>').on("click",
function(){chrome.runtime.sendMessage([31,1])});a.find(".proctorio_installed").hide()}chrome.runtime.sendMessage([5,[a.find("#pageTitleHeader").first().text().trim().replace(/"/g,"").replace(/'/g,"").replace(/\s/g," ").replace(/[ \t\r\n]+/g," "),a.find("h3").first().text().trim().replace(/"/g,"").replace(/'/g,"").replace(/\s/g," ").replace(/[ \t\r\n]+/g," ")]],function(a){chrome.runtime.lastError&&h.top.location.reload()})}chrome.runtime.sendMessage([9],function(a){});chrome.runtime.sendMessage([67])}
function l(){a.find("h1").show();B()}function n(){a.find("div.taskbuttondiv_wrapper").show();a.find("p.taskbuttonhelp").show()}function B(){a.find('form[action*="/assessment/take/launch-redirect"]').show();n();clearInterval(v);v=setInterval(function(){a.find('form[action*="/assessment/take/launch-redirect"]').show();n()},1E3);chrome.runtime.sendMessage([19,!1])}var r,w,u,z=!1,f=new ec21dc(function(){z=!0}),v=0,x=setInterval(function(){try{chrome.runtime.sendMessage([42,"lub"],function(a){chrome.runtime.lastError?
(clearInterval(x),h.top.location.reload()):"dub"!=a&&(clearInterval(x),h.top.location.reload())})}catch(b){if(b.message.startsWith("Cannot read")||b.message.startsWith("Error connecting to extension")||b.message.startsWith("Invocation of form runtime.connect")||b.message.startsWith("Extension context invalidated"))clearInterval(x),h.top.location.reload()}},1E3),a=c(document);c(function(){var b=c("#contentFrame");b&&b.length?(a=b.contents(),b.load(function(){a=b.contents();e()})):a=c(document);chrome.runtime.sendMessage([11],
function(a){chrome.runtime.lastError&&h.top.location.reload();r=a[0];w=a[1];u=h.location.protocol+a[3]+a[4];e()})});chrome.runtime.onMessage.addListener(function(a,c,d){"sendUltraStudentName"!=a.id||localStorage.getItem("ultraStudentName")||(a=document.getElementById("sidebar-user-name").getElementsByTagName("bdi"),c="",a&&a.length&&(c=Array.from(a).map(function(a){return a.innerText}).join(" ")),localStorage.setItem("ultraStudentName",c))})})($,window);
