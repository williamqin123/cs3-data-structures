/*
COPYRIGHT (C) 2013-2020 PROCTORIO INC.
USE OF THIS SOFTWARE IS PROTECTED BY COPYRIGHT LAWS AND INTERNATIONAL COPYRIGHT TREATIES,
AS WELL AS OTHER INTELLECTUAL PROPERTY LAWS AND TREATIES.
UNAUTHORIZED REPRODUCTION, DISPLAY, MODIFICATION, OR DISTRIBUTION OF THIS SOFTWARE, OR ANY PORTION OF IT,
MAY RESULT IN SEVERE CIVIL AND CRIMINAL PENALTIES, AND WILL BE PROSECUTED TO THE FULL EXTENT PERMITTED BY LAW.
USE OF THIS SOFTWARE IS CONDITIONED ON YOUR ACCEPTANCE OF OUR TERMS OF SERVICE, FOUND AT PROCTORIO.COM/TOS.
OPEN SOURCE LICENSES CAN BE FOUND IN THE LICENSE.TXT FILE OR ONLINE AT PROCTORIO.COM/LICENSES.
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.checkStringArgs=function(a,c,d){if(null==a)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return a+""};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,d,n){if(c){d=$jscomp.global;a=a.split(".");for(n=0;n<a.length-1;n++){var g=a[n];g in d||(d[g]={});d=d[g]}a=a[a.length-1];n=d[a];c=c(n);c!=n&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,d){var c=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var g=c.length,r=a.length;d=Math.max(0,Math.min(d|0,c.length));for(var h=0;h<r&&d<g;)if(c[d++]!=a[h++])return!1;return h>=r}},"es6","es3");$jscomp.findInternal=function(a,c,d){a instanceof String&&(a=String(a));for(var n=a.length,g=0;g<n;g++){var r=a[g];if(c.call(d,r,g,a))return{i:g,v:r}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");
(function(a,c){function d(a){a=a.split("+").join(" ");for(var b={},c,k=/[?&]?([^=]+)=([^&]*)/g;c=k.exec(a);)b[decodeURIComponent(c[1])]=decodeURIComponent(c[2]);return b}function n(a,c){if(a())c();else var b=setInterval(function(){a()&&(clearInterval(b),c())},100)}function g(b){b.find("a:contains('Secure Exam Proctor')").closest("div.d2l-datalist-item-content").remove();b.find("div.d2l-datalist-item-content").show();b.find(".d2l-xspl-box").each(function(){a(this).data("original-html")&&-1!=a(this).data("original-html").indexOf(".vo.msecnd.net/lti/exam")&&
a(this).hide()})}function r(a){a.find(".d2l-xspl-box").show();a.find("input[type='password']").closest("table").show();h(a)}function h(b){l=!0;b.off("DOMNodeInserted");y(b);b.on("DOMNodeInserted",function(c){g(a(c.target));h(b)})}function y(a){a.find(".proctorio-embed").hide();a.find("iframe.d2l-iframe-fullscreen").show();a.find('form[action*="quiz_summary.d2l"]').show();a.find("#d_content_inner .d2l-button").show();a.find('form[action*="quiz_newedit"]').show();a.find('form[action*="special_access.d2l"]').show()}
function v(b){b=a(b);if(l)if(b&&b.length&&b[0].location&&-1!=b[0].location.href.indexOf("quiz_summary.d2l")){var f=c.top.document.createElement("a");f.href=b[0].location.href;var e=d(f.search);e&&e.qi&&e.ou?c.top.location.href=f.origin+f.pathname+"?qi="+e.qi+"&ou="+e.ou:h(b)}else h(b);else b.on("DOMNodeInserted",function(c){g(a(c.target));l&&h(b)});setInterval(function(){l&&y(b);b.find("iframe, frame").each(function(){try{if(this&&this.src&&-1!=this.src.indexOf("://"+c.top.location.hostname)&&!this.getAttribute("data-pwd")&&
-1===this.src.indexOf("/logout")){var a=this.contentWindow||this.contentDocument.parentWindow;a&&a.document&&(this.setAttribute("data-pwd",1),v(a.document),this.onload=function(){v((this.contentWindow||this.contentDocument.parentWindow).document)})}}catch(q){}})},500);g(b)}function E(a){a=a.contents();if(a.find('img[src$="vo.msecnd.net/guides/student-logo.png"]').length){chrome.runtime.sendMessage([19,!0]);var b=a.find("div.proctorio_removeme");b.length&&b.html('<div class="take_quiz_button" style="display: block;"><a class="vui-button d2l-button vui-button-primary" href="#" role="button" tabindex="0">Live Chat</a></div>').on("click",
function(){chrome.runtime.sendMessage([31,1])}).removeClass("proctorio_removeme");a.find(".proctorio_installed").hide()}}var u,B,C,D=!1,f=new ec21dc(function(){D=!0}),z=setInterval(function(){try{chrome.runtime.sendMessage([42,"lub"],function(a){chrome.runtime.lastError?(clearInterval(z),location.reload()):"dub"!=a&&(clearInterval(z),location.reload())})}catch(b){if(b.message.startsWith("Cannot read")||b.message.startsWith("Error connecting to extension")||b.message.startsWith("Invocation of form runtime.connect")||
b.message.startsWith("Extension context invalidated"))clearInterval(z),location.reload()}},1E3),l=!1,F=function(){try{var a=document.getElementsByClassName("d2l-background-global");if(a.length){a[0].style.background="#fff";a[0].style.backgroundColor="#fff";var c=document.getElementById("d_content");if(c){c.style.background="#fff";c.style.backgroundColor="#fff";var d=document.getElementsByClassName("d2l-background-left");if(d.length)for(var k=0,f=d[0].childNodes.length;k<f;k++)d[0].childNodes[k].style.background=
"#fff",d[0].childNodes[k].style.backgroundColor="#fff";var g=document.getElementsByClassName("d2l-background-right");if(g.length)for(k=0,f=g[0].childNodes.length;k<f;k++)g[0].childNodes[k].style.background="#fff",g[0].childNodes[k].style.backgroundColor="#fff";var n=document.getElementsByClassName("d2l-page-bg");if(n.length)for(k=0,f=n[0].childNodes.length;k<f;k++)n[0].childNodes[k].style.background="#fff",n[0].childNodes[k].style.backgroundColor="#fff"}}}catch(H){}},G=setInterval(function(){document&&
document.body&&(clearInterval(G),v(document),a("div.d2l-datalist-item-content").show(),chrome.runtime.sendMessage([11],function(b){chrome.runtime.lastError&&location.reload();var g=!1;u=b[0];B=b[1];C=c.location.protocol+b[3]+b[4];if(!a("body").attr("data-p")){a("body").attr("data-p",!0);if(-1!=document.location.pathname.indexOf("quiz_summary.d2l"))if(a(".d2l-xspl-box").length||a(".proctorio-embed").length||-1!=a("h1").text().indexOf("(Remotely Proctored)")||-1!=a("h1").text().indexOf("(Secure Browser)")){a(".d2l-xspl-box").hide();
a(".proctorio-embed").hide();b=document.querySelectorAll("a.xspl-block-link");for(var e=0;e<b.length;e++)b[e].style.display="none";a(".proctorio-oembed").show();a("a.d2l-button").hide();a("button.d2l-button").hide();a("input[type='password']").closest("table").hide();if((b=document.getElementsByTagName("h2"))&&b.length)for(e=0;e<b.length;e++)if("Quiz Requirements"===b[e].innerHTML){b[e].style.display="none";break}var k=a('form[action*="quiz_summary.d2l"]');k.show();b=document.createElement("a");b.href=
document.location.href;var q=d(b.search);k.length&&q.qi?n(function(){return D},function(){var b=-1;"undefined"==typeof f.ee1?c.top.location.reload(!0):(f.ee1(u,function(a){b=a;chrome.runtime.sendMessage([91])}),f.e2cc("reason",function(){var a=f.c416(q.qi,u);f.b1457("code",null===localStorage.getItem(a+"_close")?0:localStorage[a+"_close"])}),f.f10(q.qi,u,function(d){d?(a("input[type='password']").closest("table").hide(),f.c8f4(a("span.proctoriocontrol").length?q.qi:0,u,B,function(e){if(e){var m=a("#d2l_form table:first"),
h=[];e=m.parent()[0].getElementsByClassName("proctorio-oembed");var l=[];e.length&&(e[0].querySelectorAll("p").forEach(function(a){l.push(a.innerText)}),l.length?h.push("Quiz Instructions: "+l):h.push("No quiz Instructions"));var v=function(){h.push(A+": "+w);w=A=""};if(m.length){var A,w;m.find("tr").each(function(){-1==a(this).text().indexOf("(username:")?(this.hasAttribute("id")?w=a(this).text().trim().replace(/(\r\n|\n|\r)/gm," ").replace(/\s+/g," ").trim():A=a(this).text().trim().replace(/(\r\n|\n|\r)/gm,
" ").replace(/\s+/g," ").trim(),A&&w&&v()):(w=a(this).text().split("(")[0].trim(),v())}).promise().done(function(){chrome.runtime.sendMessage([16,q.qi+"_is_"+q.course_id+"_oy_"+C,h,43829]);m.find("tbody tr:last").after(m.find("tbody tr:eq(-2)").clone());m.find("tbody tr:last").after(m.find("tbody tr:eq(-2)").clone()).find("span").text(chrome.i18n.getMessage("A226"));m.find("tbody tr:last").find("label").html(chrome.i18n.getMessage("A107")+" <strong>"+chrome.i18n.getMessage("B413")+"</strong>. <a href='https://proctorio.zendesk.com/hc/articles/200972514' target='_blank' style='text-decoration:underline'>"+
chrome.i18n.getMessage("B414")+"</a>.");if(d[0]||d[1]||d[2]){var a=chrome.i18n.getMessage("A214");!d[0]&&!d[2]||d[1]?d[0]||d[2]||!d[1]||(a=chrome.i18n.getMessage("A216")):a=chrome.i18n.getMessage("A215");m.find("tbody tr:last").after(m.find("tbody tr:eq(-2)").clone());m.find("tbody tr:last").after(m.find("tbody tr:eq(-2)").clone()).find("span").text(chrome.i18n.getMessage("A217"));m.find("tbody tr:last").find("label").text(a)}chrome.runtime.sendMessage([19,!0]);chrome.runtime.sendMessage([4,chrome.i18n.getMessage("B410")]);
f.e2cc("quizinfo",function(){f.b1457("quizinfo",h)})})}e=a("a.d2l-button");e.length||(e=a("button.d2l-button"));var t=e.first().text().trim(),x=f.c416(q.qi,u),p=document.getElementById("LockDownBrowserLaunchFrame");"undefined"!=typeof p&&null!=p&&p.remove();if(!e.length||"Start Quiz!"!=t&&"Start Exam!"!=t&&d[15]&&localStorage["ok_"+x]!=cjs.mi6(x+"__xsalt").toString())if(e.length){f.e2cc("quizoverride",function(a){2==d[15]?f.b1457("quizoverride_response","denied"):a&&"none"!=a?a==cjs.mi6(x+"__xsalt").toString()?
(chrome.runtime.sendMessage([3,["_trackEvent","PGHZ","yFrr_ca",c.location.hostname]]),localStorage["ok_"+x]=a,f.b1457("quizoverride_response","success"),document.location.reload()):f.b1457("quizoverride_response","invalid"):f.b1457("quizoverride",x)});h.push("LOCKED");t=a("form h2");if(2<t.length){t=t[t.length-2];for(p=t.nextSibling;p.style.display="none",p=p.nextSibling,p&&"undefined"!=typeof p.tagName&&"table"!=p.tagName&&"h2"!=p.tagName;);p=document.createElement("div");p.innerHTML=chrome.i18n.getMessage("A159");
t.parentNode.insertBefore(p,t.nextSibling)}e.remove()}else a("#d2l_minibar span.d2l-personaltools-text").length&&a.get(chrome.extension.getURL("webassets/q57s.html"),function(b,d,c){a("#d2l_form").append(mus.th(b,{A153:chrome.i18n.getMessage("A153"),A157:chrome.i18n.getMessage("A157"),A158:chrome.i18n.getMessage("A158")}));a("#proctorio_begin_quiz").css("font-size",18)});else{-1!=location.href.indexOf("#")&&(location.href=location.href.split("#")[0]);var y=e.closest(".dba_b");e.after(e.clone().css("margin-top",
5).show().one("keypress click",function(e){if(!g){g=!0;e.preventDefault();a(this).off().remove();e=a("h1").text();var h="Unknown";h=-1!=e.indexOf("Summary -")?e.split("Summary -")[1]:e;a("h1").parent().hide();a("ol.d2l-breadcrumbs li.d2l-breadcrumb:last span").text(h);document.title=h;k.attr("id","proctorio_poster");k.find('input[type="password"]').attr("id","proctorio_passer");k.hide();var p=a("#d2l_minibar span.d2l-personaltools-text").length;n(function(){return-1<b},function(){f.b8d(d,k.parent()[0],
q.qi,u,B,"d2",a('label:contains("(username:")').text().split("(username:")[0].trim(),"proctorio_poster","proctorio_passer",h,"body",z,p,b);var c=document.getElementsByTagName("d2l-floating-buttons");if(c.length)for(var e=0,g=c.length;e<g;e++)c[e].style.display="none";else y.hide()});F();e=document.getElementsByClassName("d2l-max-width");if(e.length)for(var l=0;l<e.length;l++){var m=c.getComputedStyle(e[l]);m&&m.hasOwnProperty("max-width")&&"function"==typeof m["max-width"].replace&&!isNaN(m["max-width"].replace("px",
""))&&1100<parseInt(m["max-width"],10)||(e[l].style.maxWidth="1120px",e[l].style.width="100%")}a(".d2l-xspl-box").length||a(".proctorio-embed").length||chrome.runtime.sendMessage([3,["_trackEvent","PGHZ","BRoW_d2",c.location.hostname]]);try{document.off("DOMNodeInserted")}catch(I){}}})).remove();chrome.runtime.sendMessage([19,!0]);chrome.runtime.sendMessage([4,chrome.i18n.getMessage("B410")]);document.getElementById("d_content_r_p").style.paddingBottom="15px"}}else r(a(document))})):r(a(document))}))}):
r(a(document))}else r(a(document));else if(-1!=document.location.pathname.indexOf("/viewContent/")){var l=a(".d2l-iframe");l.length&&-1!=l[0].src.indexOf("quiz_summary.d2l")?(b=document.createElement("a"),b.href=a(".d2l-iframe")[0].src,(q=d(b.search))&&q.qi&&q.ou?c.top.location.href=b.origin+b.pathname+"?qi="+q.qi+"&ou="+q.ou:(h(a(document)),chrome.runtime.sendMessage([19,!1]))):(l.length&&setInterval(function(){E(l)},1E3),chrome.runtime.sendMessage([19,!1]),h(a(document)))}else h(a(document)),a(".proctorio-oembed").show(),
chrome.runtime.sendMessage([19,!1]);chrome.runtime.sendMessage([5,[a("h1").last().text().trim().replace(/"/g,"").replace(/'/g,"").replace(/\s/g," ").replace(/[ \t\r\n]+/g," "),a(".d2l-navbar-title").first().text().trim().replace(/"/g,"").replace(/'/g,"").replace(/\s/g," ").replace(/[ \t\r\n]+/g," ")]],function(a){chrome.runtime.lastError&&location.reload()})}chrome.runtime.sendMessage([9],function(a){})}))},500)})($,window);
